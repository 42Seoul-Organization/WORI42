{"ast":null,"code":"var _jsxFileName = \"/Users/jaemin/Desktop/work/working/react/wori42/react/src/Component/Example/Compose/Compose.js\";\nimport React, { useState, useCallback, useEffect, useRef } from \"react\";\nimport MapGL, { FlyToInterpolator } from \"react-map-gl\";\nimport \"mapbox-gl/dist/mapbox-gl.css\";\nimport request from \"../Axios/request\";\nimport InputBox from \"./InputBoxGrid\";\nimport Marker from \"./Marker/Marker\";\nimport Sliderbar from \"./Slidebar/Sliderbar\";\nimport Footer from \"./Footer/Footer\";\nimport SideBar from \"./SideBar/SideBar\";\nimport Pin from \"../Marker/Pin\";\nimport \"./compose.scss\"; // import Chart from \"../Chart/Chart\";\n\nimport dotenv from \"dotenv\";\ndotenv.config();\n\nfunction Compose() {\n  const [info, setInfo] = useState({\n    longitude: 127.024612,\n    latitude: 37.5326,\n    zoom: 5.5,\n    pitch: 0,\n    bearing: 0,\n    transitionInterpolator: new FlyToInterpolator({\n      speed: 1.2\n    }),\n    transitionDuration: 1000,\n    searchInfo: \"\",\n    isMain: true\n  });\n  const [userData, setUserData] = useState([]);\n  const [convertedData, setConvertedData] = useState([]);\n  const [idx, setIdx] = useState(0);\n  const map_ref = useRef();\n  const mainSearchInput = useCallback(vp => {\n    setInfo({ ...info,\n      searchInfo: vp.target.value\n    });\n    console.log(\"hh\");\n  });\n\n  const getAddress = data => {\n    data.map(data => request(\"get\", `https://maps.googleapis.com/maps/api/geocode/json`, {\n      latlng: data[0] + \",\" + data[1],\n      key: process.env.REACT_APP_Google_Token\n    }).then(res => {\n      let result = {\n        province: res.data.results[0].address_components[1].long_name,\n        city: res.data.results[0].address_components[2].long_name,\n        group: \"NEW\",\n        infection_case: \"User_data\",\n        confirmed: 1,\n        latitude: data[1],\n        longitude: data[0],\n        time: \"UTF로 해주세요\",\n        name: \"hochan\"\n      };\n      setConvertedData([...convertedData, result]);\n    }).catch(res => {\n      console.log(res);\n    }));\n  };\n\n  const go = infor => {\n    request(\"get\", `https://maps.googleapis.com/maps/api/geocode/json`, {\n      address: infor,\n      key: process.env.REACT_APP_Google_Token\n    }).then(res => {\n      console.log(\"search\");\n      setInfo({ ...info,\n        isMain: false,\n        latitude: res.data.results[0].geometry.location.lat,\n        longitude: res.data.results[0].geometry.location.lng,\n        searchInfo: infor,\n        zoom: 14,\n        transitionInterpolator: new FlyToInterpolator(),\n        transitionDuration: 1000\n      });\n\n      if (markerList.length <= 6) {\n        setMarkerList(markerList.concat([[res.data.results[0].geometry.location.lat, res.data.results[0].geometry.location.lng, infor]])); // 현재 지도에서 보고 있는 좌표의 정 가운데 좌표를 넣어줘야 함\n      }\n    }).catch(res => {\n      console.log(res);\n    });\n  };\n\n  const goToViewPort = useCallback(() => {\n    request(\"get\", `https://maps.googleapis.com/maps/api/geocode/json`, {\n      address: info.searchInfo,\n      key: process.env.REACT_APP_Google_Token\n    }).then(res => {\n      console.log(\"search\");\n      setInfo({ ...info,\n        isMain: false,\n        latitude: res.data.results[0].geometry.location.lat,\n        longitude: res.data.results[0].geometry.location.lng,\n        zoom: 14,\n        transitionInterpolator: new FlyToInterpolator(),\n        transitionDuration: 1000\n      });\n    }).catch(res => {\n      console.log(res);\n    });\n  }, [info]);\n  useEffect(() => {\n    if (info.isMain && info.longitude <= 128) {\n      const interval = setInterval(() => {\n        setInfo({ ...info,\n          latitude: info.latitude + 0.005,\n          longitude: info.longitude + 0.005\n        });\n      }, 50);\n      return () => clearInterval(interval);\n    }\n\n    return;\n  }, [info]);\n  useEffect(() => {\n    request(\"post\", `http://localhost:3013/covid19/data/user`, {\n      user_data: [{\n        province: \"Seoul\",\n        city: \"Yongsan-gu\",\n        group: \"TRUE\",\n        infection_case: \"Itaewon Clubs\",\n        confirmed: 139,\n        latitude: 37.538621,\n        longitude: 126.992652,\n        time: \"UTF로 해주세요\",\n        name: \"hochan\"\n      }, {\n        province: \"Seoul\",\n        city: \"Gwanak-gu\",\n        group: \"TRUE\",\n        infection_case: \"Richway\",\n        confirmed: 119,\n        latitude: 37.48208,\n        longitude: 126.901384,\n        time: \"UTF로 해주세요\",\n        name: \"Jamin\"\n      }]\n    }).then(res => {\n      setUserData(res.data);\n    }).catch(err => {\n      console.log(err);\n    });\n  }, []);\n  const [markerList, setMarkerList] = useState([]);\n\n  const func_create = name => {\n    go(name);\n\n    if (markerList.length <= 6) {\n      setMarkerList(markerList.concat([[info.latitude, info.longitude, name]])); // 현재 지도에서 보고 있는 좌표의 정 가운데 좌표를 넣어줘야 함\n    }\n\n    setIdx(idx + 1);\n    console.log(markerList);\n  };\n\n  const func_submit = () => {\n    console.log(markerList);\n    getAddress(markerList);\n    console.log(convertedData);\n  };\n\n  const func_revise = (idx, latitude, longitude) => {\n    let revised = markerList.slice();\n    revised[idx][0] = latitude;\n    revised[idx][1] = longitude;\n    setMarkerList(revised);\n  };\n\n  return /*#__PURE__*/React.createElement(MapGL, Object.assign({}, info, {\n    width: \"100vw\",\n    height: \"100vh\" // mapStyle=\"mapbox://styles/holee/ckcmzzc5y24hb1ip8lnkdt8sq\"\n    ,\n    mapboxApiAccessToken: process.env.REACT_APP_MAPBOX_THEME,\n    onViewportChange: info.isMain ? () => {\n      \"\";\n    } : nextViewport => setInfo({ ...info,\n      ...nextViewport\n    }) // mapStyle=\"mapbox://styles/mapbox/streets-v11\"\n    // mapStyle=\"mapbox://styles/mapbox/dark-v9\"\n    ,\n    mapStyle: \"mapbox://styles/holee/ckd0isb0511wr1iqvi1347ng8\",\n    ref: map_ref // mapboxApiAccessToken={process.env.REACT_APP_MAPBOX_TOKEN}\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(Marker, {\n    userData: userData,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 7\n    }\n  }), markerList.map((data, index) => /*#__PURE__*/React.createElement(Pin, {\n    key: index,\n    num: index,\n    latitude: data[0],\n    longitude: data[1],\n    func_revise: func_revise,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(InputBox, {\n    info: info,\n    setInfo: setInfo,\n    mainSearchInput: mainSearchInput,\n    goToViewPort: goToViewPort,\n    isMain: info.isMain,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 11\n    }\n  })), info.isMain ? () => {\n    \"\";\n  } : /*#__PURE__*/React.createElement(Sliderbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 11\n    }\n  }), info.isMain ? () => {\n    \"\";\n  } : /*#__PURE__*/React.createElement(SideBar, {\n    func_create: func_create,\n    func_submit: func_submit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 9\n    }\n  })));\n}\n\nexport default Compose;","map":{"version":3,"sources":["/Users/jaemin/Desktop/work/working/react/wori42/react/src/Component/Example/Compose/Compose.js"],"names":["React","useState","useCallback","useEffect","useRef","MapGL","FlyToInterpolator","request","InputBox","Marker","Sliderbar","Footer","SideBar","Pin","dotenv","config","Compose","info","setInfo","longitude","latitude","zoom","pitch","bearing","transitionInterpolator","speed","transitionDuration","searchInfo","isMain","userData","setUserData","convertedData","setConvertedData","idx","setIdx","map_ref","mainSearchInput","vp","target","value","console","log","getAddress","data","map","latlng","key","process","env","REACT_APP_Google_Token","then","res","result","province","results","address_components","long_name","city","group","infection_case","confirmed","time","name","catch","go","infor","address","geometry","location","lat","lng","markerList","length","setMarkerList","concat","goToViewPort","interval","setInterval","clearInterval","user_data","err","func_create","func_submit","func_revise","revised","slice","REACT_APP_MAPBOX_THEME","nextViewport","index"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useEffect, useRef } from \"react\";\nimport MapGL, { FlyToInterpolator } from \"react-map-gl\";\nimport \"mapbox-gl/dist/mapbox-gl.css\";\n\nimport request from \"../Axios/request\";\nimport InputBox from \"./InputBoxGrid\";\nimport Marker from \"./Marker/Marker\";\nimport Sliderbar from \"./Slidebar/Sliderbar\";\nimport Footer from \"./Footer/Footer\";\nimport SideBar from \"./SideBar/SideBar\";\nimport Pin from \"../Marker/Pin\";\nimport \"./compose.scss\";\n\n// import Chart from \"../Chart/Chart\";\nimport dotenv from \"dotenv\";\n\ndotenv.config();\n\nfunction Compose() {\n  const [info, setInfo] = useState({\n    longitude: 127.024612,\n    latitude: 37.5326,\n    zoom: 5.5,\n    pitch: 0,\n    bearing: 0,\n    transitionInterpolator: new FlyToInterpolator({ speed: 1.2 }),\n    transitionDuration: 1000,\n    searchInfo: \"\",\n    isMain: true,\n  });\n  const [userData, setUserData] = useState([]);\n  const [convertedData, setConvertedData] = useState([]);\n  const [idx, setIdx] = useState(0);\n  const map_ref = useRef();\n\n  const mainSearchInput = useCallback((vp) => {\n    setInfo({\n      ...info,\n      searchInfo: vp.target.value,\n    });\n    console.log(\"hh\");\n  });\n\n  const getAddress = (data) => {\n    data.map((data) =>\n      request(\"get\", `https://maps.googleapis.com/maps/api/geocode/json`, {\n        latlng: data[0] + \",\" + data[1],\n        key: process.env.REACT_APP_Google_Token,\n      })\n        .then((res) => {\n          let result = {\n            province: res.data.results[0].address_components[1].long_name,\n            city: res.data.results[0].address_components[2].long_name,\n            group: \"NEW\",\n            infection_case: \"User_data\",\n            confirmed: 1,\n            latitude: data[1],\n            longitude: data[0],\n            time: \"UTF로 해주세요\",\n            name: \"hochan\",\n          };\n          setConvertedData([...convertedData, result]);\n        })\n        .catch((res) => {\n          console.log(res);\n        })\n    );\n  };\n\n  const go = (infor) => {\n    request(\"get\", `https://maps.googleapis.com/maps/api/geocode/json`, {\n      address: infor,\n      key: process.env.REACT_APP_Google_Token,\n    })\n      .then((res) => {\n        console.log(\"search\");\n        setInfo({\n          ...info,\n          isMain: false,\n          latitude: res.data.results[0].geometry.location.lat,\n          longitude: res.data.results[0].geometry.location.lng,\n          searchInfo: infor,\n          zoom: 14,\n          transitionInterpolator: new FlyToInterpolator(),\n          transitionDuration: 1000,\n        });\n        if (markerList.length <= 6) {\n          setMarkerList(\n            markerList.concat([\n              [\n                res.data.results[0].geometry.location.lat,\n                res.data.results[0].geometry.location.lng,\n                infor,\n              ],\n            ])\n          ); // 현재 지도에서 보고 있는 좌표의 정 가운데 좌표를 넣어줘야 함\n        }\n      })\n      .catch((res) => {\n        console.log(res);\n      });\n  };\n\n  const goToViewPort = useCallback(() => {\n    request(\"get\", `https://maps.googleapis.com/maps/api/geocode/json`, {\n      address: info.searchInfo,\n      key: process.env.REACT_APP_Google_Token,\n    })\n      .then((res) => {\n        console.log(\"search\");\n        setInfo({\n          ...info,\n          isMain: false,\n          latitude: res.data.results[0].geometry.location.lat,\n          longitude: res.data.results[0].geometry.location.lng,\n          zoom: 14,\n          transitionInterpolator: new FlyToInterpolator(),\n          transitionDuration: 1000,\n        });\n      })\n      .catch((res) => {\n        console.log(res);\n      });\n  }, [info]);\n\n  useEffect(() => {\n    if (info.isMain && info.longitude <= 128) {\n      const interval = setInterval(() => {\n        setInfo({\n          ...info,\n          latitude: info.latitude + 0.005,\n          longitude: info.longitude + 0.005,\n        });\n      }, 50);\n      return () => clearInterval(interval);\n    }\n    return;\n  }, [info]);\n\n  useEffect(() => {\n    request(\"post\", `http://localhost:3013/covid19/data/user`, {\n      user_data: [\n        {\n          province: \"Seoul\",\n          city: \"Yongsan-gu\",\n          group: \"TRUE\",\n          infection_case: \"Itaewon Clubs\",\n          confirmed: 139,\n          latitude: 37.538621,\n          longitude: 126.992652,\n          time: \"UTF로 해주세요\",\n          name: \"hochan\",\n        },\n        {\n          province: \"Seoul\",\n          city: \"Gwanak-gu\",\n          group: \"TRUE\",\n          infection_case: \"Richway\",\n          confirmed: 119,\n          latitude: 37.48208,\n          longitude: 126.901384,\n          time: \"UTF로 해주세요\",\n          name: \"Jamin\",\n        },\n      ],\n    })\n      .then((res) => {\n        setUserData(res.data);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }, []);\n\n  const [markerList, setMarkerList] = useState([]);\n\n  const func_create = (name) => {\n    go(name);\n\n    if (markerList.length <= 6) {\n      setMarkerList(markerList.concat([[info.latitude, info.longitude, name]])); // 현재 지도에서 보고 있는 좌표의 정 가운데 좌표를 넣어줘야 함\n    }\n    setIdx(idx + 1);\n    console.log(markerList);\n  };\n\n  const func_submit = () => {\n    console.log(markerList);\n    getAddress(markerList);\n    console.log(convertedData);\n  };\n\n  const func_revise = (idx, latitude, longitude) => {\n    let revised = markerList.slice();\n    revised[idx][0] = latitude;\n    revised[idx][1] = longitude;\n    setMarkerList(revised);\n  };\n\n  return (\n    <MapGL\n      {...info}\n      width=\"100vw\"\n      height=\"100vh\"\n      // mapStyle=\"mapbox://styles/holee/ckcmzzc5y24hb1ip8lnkdt8sq\"\n      mapboxApiAccessToken={process.env.REACT_APP_MAPBOX_THEME}\n      onViewportChange={\n        info.isMain\n          ? () => {\n              \"\";\n            }\n          : (nextViewport) => setInfo({ ...info, ...nextViewport })\n      }\n      // mapStyle=\"mapbox://styles/mapbox/streets-v11\"\n      // mapStyle=\"mapbox://styles/mapbox/dark-v9\"\n      mapStyle=\"mapbox://styles/holee/ckd0isb0511wr1iqvi1347ng8\"\n      ref={map_ref}\n      // mapboxApiAccessToken={process.env.REACT_APP_MAPBOX_TOKEN}\n    >\n      <Marker userData={userData} />\n\n      {markerList.map((data, index) => (\n        <Pin\n          key={index}\n          num={index}\n          latitude={data[0]}\n          longitude={data[1]}\n          func_revise={func_revise}\n        />\n      ))}\n\n      <div className=\"container\">\n        <div className=\"item\">\n          <InputBox\n            info={info}\n            setInfo={setInfo}\n            mainSearchInput={mainSearchInput}\n            goToViewPort={goToViewPort}\n            isMain={info.isMain}\n          />\n        </div>\n        {info.isMain ? (\n          () => {\n            \"\";\n          }\n        ) : (\n          <Sliderbar />\n        )}\n        {info.isMain ? (\n          () => {\n            \"\";\n          }\n        ) : (\n          <SideBar func_create={func_create} func_submit={func_submit} />\n        )}\n        <Footer />\n        {/* <Chart /> */}\n      </div>\n    </MapGL>\n  );\n}\n\nexport default Compose;\n"]},"metadata":{},"sourceType":"module"}