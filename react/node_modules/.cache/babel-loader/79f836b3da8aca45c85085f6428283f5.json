{"ast":null,"code":"/**\r\n * Pie tick module.\r\n */\nimport { __extends } from \"tslib\";\n/**\r\n * ============================================================================\r\n * IMPORTS\r\n * ============================================================================\r\n * @hidden\r\n */\n\nimport { Tick } from \"../elements/Tick\";\nimport { MutableValueDisposer, MultiDisposer } from \"../../core/utils/Disposer\";\nimport { registry } from \"../../core/Registry\";\n/**\r\n * ============================================================================\r\n * MAIN CLASS\r\n * ============================================================================\r\n * @hidden\r\n */\n\n/**\r\n * Draws an tick line for a pie slice connecting it to a related label.\r\n *\r\n * @see {@link IPieTickEvents} for a list of available events\r\n * @see {@link IPieTickAdapters} for a list of available Adapters\r\n */\n\nvar PieTick =\n/** @class */\nfunction (_super) {\n  __extends(PieTick, _super);\n  /**\r\n   * Constructor\r\n   */\n\n\n  function PieTick() {\n    var _this = _super.call(this) || this;\n    /**\r\n     * A label element this tick is attached to.\r\n     */\n\n\n    _this._label = new MutableValueDisposer();\n    /**\r\n     * A slice element this tick is attached to.\r\n     */\n\n    _this._slice = new MutableValueDisposer();\n    _this.className = \"PieTick\";\n    _this.element = _this.paper.add(\"polyline\");\n\n    _this._disposers.push(_this._label);\n\n    _this._disposers.push(_this._slice);\n\n    _this.applyTheme();\n\n    return _this;\n  }\n  /**\r\n   * Draws the tick element.\r\n   *\r\n   * @ignore Exclude from docs\r\n   */\n\n\n  PieTick.prototype.draw = function () {\n    _super.prototype.draw.call(this);\n\n    var slice = this.slice;\n    var label = this.label;\n    var series = slice.dataItem.component;\n\n    if (slice && slice.radius > 0 && label && label.text) {\n      var x0 = slice.dx + slice.slice.dx + slice.pixelX + slice.ix * slice.radius * slice.scale;\n      var y0 = slice.dy + slice.slice.dy + slice.pixelY + slice.iy * slice.radiusY * slice.scale;\n      var x1 = void 0;\n      var y1 = void 0;\n      var x2 = void 0;\n      var y2 = void 0;\n\n      if (series.alignLabels) {\n        x1 = label.pixelX - this.length;\n        y1 = label.pixelY;\n        x2 = label.pixelX;\n        y2 = y1;\n\n        if (label.horizontalCenter == \"right\") {\n          x1 += 2 * this.length;\n          x2 = x1 - this.length;\n        }\n      } else {\n        var r = label.pixelRadius(slice.radius);\n        x1 = x0 + r * slice.ix;\n        y1 = y0 + r * slice.iy;\n        x2 = x1;\n        y2 = y1;\n      }\n\n      this.element.attr({\n        \"points\": [x0, y0, x1, y1, x2, y2]\n      });\n    }\n  };\n\n  Object.defineProperty(PieTick.prototype, \"slice\", {\n    /**\r\n     * @return Slice\r\n     */\n    get: function () {\n      return this._slice.get();\n    },\n\n    /**\r\n     * Slice element tick is attached to.\r\n     *\r\n     * @param slice  Slice\r\n     */\n    set: function (slice) {\n      this._slice.set(slice, new MultiDisposer([slice.events.on(\"transformed\", this.invalidate, this), slice.events.on(\"validated\", this.invalidate, this)]));\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(PieTick.prototype, \"label\", {\n    /**\r\n     * @return Label\r\n     */\n    get: function () {\n      return this._label.get();\n    },\n\n    /**\r\n     * Label element tick is attached to.\r\n     *\r\n     * @param label  Label\r\n     */\n    set: function (label) {\n      this._label.set(label, label.events.on(\"transformed\", this.invalidate, this, false));\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return PieTick;\n}(Tick);\n\nexport { PieTick };\n/**\r\n * Register class in system, so that it can be instantiated using its name from\r\n * anywhere.\r\n *\r\n * @ignore\r\n */\n\nregistry.registeredClasses[\"PieTick\"] = PieTick;","map":{"version":3,"sources":["../../../../../src/.internal/charts/elements/PieTick.ts"],"names":[],"mappings":"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","sourcesContent":["/**\r\n * Pie tick module.\r\n */\r\n\r\n/**\r\n * ============================================================================\r\n * IMPORTS\r\n * ============================================================================\r\n * @hidden\r\n */\r\nimport { Tick, ITickProperties, ITickAdapters, ITickEvents } from \"../elements/Tick\";\r\nimport { AxisLabelCircular } from \"../axes/AxisLabelCircular\";\r\nimport { Slice } from \"../../core/elements/Slice\";\r\nimport { MutableValueDisposer, MultiDisposer } from \"../../core/utils/Disposer\";\r\nimport { PieSeries } from \"../series/PieSeries\"\r\nimport { registry } from \"../../core/Registry\";\r\n\r\n\r\n/**\r\n * ============================================================================\r\n * REQUISITES\r\n * ============================================================================\r\n * @hidden\r\n */\r\n\r\n/**\r\n * Defines properties for [[PieTick]].\r\n */\r\nexport interface IPieTickProperties extends ITickProperties { }\r\n\r\n/**\r\n * Defines events for [[PieTick]].\r\n */\r\nexport interface IPieTickEvents extends ITickEvents { }\r\n\r\n/**\r\n * Defines adapters for [[PieTick]].\r\n *\r\n * @see {@link Adapter}\r\n */\r\nexport interface IPieTickAdapters extends ITickAdapters, IPieTickProperties { }\r\n\r\n\r\n/**\r\n * ============================================================================\r\n * MAIN CLASS\r\n * ============================================================================\r\n * @hidden\r\n */\r\n\r\n/**\r\n * Draws an tick line for a pie slice connecting it to a related label.\r\n *\r\n * @see {@link IPieTickEvents} for a list of available events\r\n * @see {@link IPieTickAdapters} for a list of available Adapters\r\n */\r\nexport class PieTick extends Tick {\r\n\r\n\t/**\r\n\t * Defines available properties.\r\n\t */\r\n\tpublic _properties!: IPieTickProperties;\r\n\r\n\t/**\r\n\t * Defines available adapters.\r\n\t */\r\n\tpublic _adapter!: IPieTickAdapters;\r\n\r\n\t/**\r\n\t * Defines available events.\r\n\t */\r\n\tpublic _events!: IPieTickEvents;\r\n\r\n\t/**\r\n\t * A label element this tick is attached to.\r\n\t */\r\n\tprotected _label = new MutableValueDisposer<AxisLabelCircular>();\r\n\r\n\t/**\r\n\t * A slice element this tick is attached to.\r\n\t */\r\n\tprotected _slice = new MutableValueDisposer<Slice>();\r\n\r\n\t/**\r\n\t * Constructor\r\n\t */\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.className = \"PieTick\";\r\n\t\tthis.element = this.paper.add(\"polyline\");\r\n\t\tthis._disposers.push(this._label);\r\n\t\tthis._disposers.push(this._slice);\r\n\t\tthis.applyTheme();\r\n\t}\r\n\r\n\t/**\r\n\t * Draws the tick element.\r\n\t *\r\n\t * @ignore Exclude from docs\r\n\t */\r\n\tpublic draw(): void {\r\n\t\tsuper.draw();\r\n\r\n\t\tlet slice: Slice = this.slice;\r\n\t\tlet label = this.label;\r\n\r\n\t\tlet series = <PieSeries>slice.dataItem.component;\r\n\r\n\t\tif (slice && slice.radius > 0 && label && label.text) {\r\n\t\t\tlet x0 = slice.dx + slice.slice.dx + slice.pixelX + slice.ix * slice.radius * slice.scale;\r\n\t\t\tlet y0 = slice.dy + slice.slice.dy + slice.pixelY + slice.iy * slice.radiusY * slice.scale;\r\n\r\n\t\t\tlet x1: number;\r\n\t\t\tlet y1: number;\r\n\r\n\t\t\tlet x2: number;\r\n\t\t\tlet y2: number;\r\n\r\n\t\t\tif (series.alignLabels) {\r\n\t\t\t\tx1 = label.pixelX - this.length;\r\n\t\t\t\ty1 = label.pixelY;\r\n\r\n\t\t\t\tx2 = label.pixelX;\r\n\t\t\t\ty2 = y1;\r\n\r\n\t\t\t\tif (label.horizontalCenter == \"right\") {\r\n\t\t\t\t\tx1 += 2 * this.length;\r\n\t\t\t\t\tx2 = x1 - this.length;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconst r = label.pixelRadius(slice.radius);\r\n\r\n\t\t\t\tx1 = x0 + r * slice.ix;\r\n\t\t\t\ty1 = y0 + r * slice.iy;\r\n\r\n\t\t\t\tx2 = x1;\r\n\t\t\t\ty2 = y1;\r\n\t\t\t}\r\n\r\n\t\t\tthis.element.attr({ \"points\": [x0, y0, x1, y1, x2, y2] });\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Slice element tick is attached to.\r\n\t *\r\n\t * @param slice  Slice\r\n\t */\r\n\tpublic set slice(slice: Slice) {\r\n\t\tthis._slice.set(slice, new MultiDisposer([\r\n\t\t\tslice.events.on(\"transformed\", this.invalidate, this),\r\n\t\t\tslice.events.on(\"validated\", this.invalidate, this)\r\n\t\t]));\r\n\t}\r\n\r\n\t/**\r\n\t * @return Slice\r\n\t */\r\n\tpublic get slice(): Slice {\r\n\t\treturn this._slice.get();\r\n\t}\r\n\r\n\t/**\r\n\t * Label element tick is attached to.\r\n\t *\r\n\t * @param label  Label\r\n\t */\r\n\tpublic set label(label: AxisLabelCircular) {\r\n\t\tthis._label.set(label, label.events.on(\"transformed\", this.invalidate, this, false));\r\n\t}\r\n\r\n\t/**\r\n\t * @return Label\r\n\t */\r\n\tpublic get label(): AxisLabelCircular {\r\n\t\treturn this._label.get();\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * Register class in system, so that it can be instantiated using its name from\r\n * anywhere.\r\n *\r\n * @ignore\r\n */\r\nregistry.registeredClasses[\"PieTick\"] = PieTick;\r\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}